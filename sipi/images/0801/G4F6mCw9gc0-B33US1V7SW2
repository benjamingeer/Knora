<?xml version="1.0" encoding="UTF-8"?>

<!-- diplomatic version -->

<xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">

    <xsl:output method="html" encoding="utf-8" indent="yes"/>

    <xsl:template match="p">
        <p><xsl:apply-templates/></p>
    </xsl:template>

    <xsl:template match="regionref|entity">
      <a>
        <xsl:attribute name="class">salsah-link</xsl:attribute>
        <xsl:attribute name="href"><xsl:value-of select="@href"/></xsl:attribute>
        <xsl:apply-templates/>
      </a>
    </xsl:template>

    <xsl:template match="formula[count(text()) > 0]">
        <span class="math"><xsl:choose>
                <xsl:when test="@border">
                    <xsl:attribute name="class"><xsl:value-of select="@border"/></xsl:attribute>
                </xsl:when>
            </xsl:choose>\(<xsl:apply-templates/>\)</span>
    </xsl:template>

    <xsl:template match="em">
        <em><xsl:apply-templates/></em>
    </xsl:template>

</xsl:transform>