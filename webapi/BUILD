package(default_visibility = ["//visibility:public"])

load("@io_bazel_rules_twirl//twirl:twirl.bzl", "twirl_templates")

twirl_templates(
  name = "twirl-templates",
  source_directory = "src",
  include_play_imports = False,
  srcs = glob(["src/main/twirl/**/*.scala.html"])
    + glob(["src/main/twirl/**/*.scala.xml"])
    + glob(["src/main/twirl/**/*.scala.js"])
    + glob(["src/main/twirl/**/*.scala.txt"]),
)

filegroup(
    name = "webapi_resources",
    srcs = glob([
        "src/main/resources/**",
    ]),
)

scala_library(
    name = "webapi",
    srcs = glob(["src/main/scala/org/knora/webapi/**/*.scala"]) + [":twirl-templates"],
    resources = [":webapi_resources"],
    deps = [
        "@maven//:cglib_cglib_nodep",
        "@maven//:ch_megard_akka_http_cors_2_12",
        "@maven//:ch_qos_logback_logback_classic",
        "@maven//:ch_qos_logback_logback_core",
        "@maven//:com_eatthepath_fast_uuid",
        "@maven//:com_esotericsoftware_kryo_shaded",
        "@maven//:com_esotericsoftware_minlog",
        "@maven//:com_fasterxml_jackson_core_jackson_annotations",
        "@maven//:com_fasterxml_jackson_core_jackson_core",
        "@maven//:com_fasterxml_jackson_core_jackson_databind",
        "@maven//:com_fasterxml_jackson_dataformat_jackson_dataformat_yaml",
        "@maven//:com_fasterxml_jackson_module_jackson_module_paranamer",
        "@maven//:com_fasterxml_jackson_module_jackson_module_scala_2_12",
        "@maven//:com_github_andrewoma_dexx_collection",
        "@maven//:com_github_ben_manes_caffeine_caffeine",
        "@maven//:com_github_jsonld_java_jsonld_java",
        "@maven//:com_github_scopt_scopt_2_12",
        "@maven//:com_github_swagger_akka_http_swagger_akka_http_2_12",
        "@maven//:com_google_code_gson_gson",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
        "@maven//:com_google_gwt_gwt_servlet",
        "@maven//:com_ibm_icu_icu4j",
        "@maven//:com_jsuereth_scala_arm_2_12",
        "@maven//:com_opencsv_opencsv",
        "@maven//:com_pauldijou_jwt_core_2_12",
        "@maven//:com_pauldijou_jwt_core_impl_2_12",
        "@maven//:com_pauldijou_jwt_json_common_2_12",
        "@maven//:com_pauldijou_jwt_spray_json_2_12",
        "@maven//:com_sksamuel_diff_diff",
        "@maven//:com_softwaremill_quicklens_quicklens_2_12",
        "@maven//:com_sun_activation_javax_activation",
        "@maven//:com_tdunning_t_digest",
        "@maven//:com_thoughtworks_paranamer_paranamer",
        "@maven//:com_twitter_chill_2_12",
        "@maven//:com_twitter_chill_java",
        "@maven//:com_typesafe_akka_akka_actor_2_12",
        "@maven//:com_typesafe_akka_akka_agent_2_12",
        "@maven//:com_typesafe_akka_akka_http_2_12",
        "@maven//:com_typesafe_akka_akka_http_core_2_12",
        "@maven//:com_typesafe_akka_akka_http_jackson_2_12",
        "@maven//:com_typesafe_akka_akka_http_spray_json_2_12",
        "@maven//:com_typesafe_akka_akka_http_testkit_2_12",
        "@maven//:com_typesafe_akka_akka_http_xml_2_12",
        "@maven//:com_typesafe_akka_akka_parsing_2_12",
        "@maven//:com_typesafe_akka_akka_protobuf_2_12",
        "@maven//:com_typesafe_akka_akka_slf4j_2_12",
        "@maven//:com_typesafe_akka_akka_stream_2_12",
        "@maven//:com_typesafe_config",
        "@maven//:com_typesafe_scala_logging_scala_logging_2_12",
        "@maven//:com_typesafe_ssl_config_core_2_12",
        "@maven//:commons_beanutils_commons_beanutils",
        "@maven//:commons_cli_commons_cli",
        "@maven//:commons_codec_commons_codec",
        "@maven//:commons_collections_commons_collections",
        "@maven//:commons_digester_commons_digester",
        "@maven//:commons_io_commons_io",
        "@maven//:commons_logging_commons_logging",
        "@maven//:commons_validator_commons_validator",
        "@maven//:de_heikoseeberger_akka_http_circe_2_12",
        "@maven//:io_burt_jmespath_core",
        "@maven//:io_burt_jmespath_jackson",
        "@maven//:io_circe_circe_core_2_12",
        "@maven//:io_circe_circe_jawn_2_12",
        "@maven//:io_circe_circe_numbers_2_12",
        "@maven//:io_gatling_gatling_app",
        "@maven//:io_gatling_gatling_charts",
        "@maven//:io_gatling_gatling_commons",
        "@maven//:io_gatling_gatling_core",
        "@maven//:io_gatling_gatling_graphite",
        "@maven//:io_gatling_gatling_http",
        "@maven//:io_gatling_gatling_http_client",
        "@maven//:io_gatling_gatling_jdbc",
        "@maven//:io_gatling_gatling_jms",
        "@maven//:io_gatling_gatling_netty_util",
        "@maven//:io_gatling_gatling_recorder",
        "@maven//:io_gatling_gatling_redis",
        "@maven//:io_gatling_gatling_test_framework",
        "@maven//:io_gatling_highcharts_gatling_charts_highcharts",
        "@maven//:io_gatling_jsonpath_2_12",
        "@maven//:io_kamon_kamon_akka_2_12",
        "@maven//:io_kamon_kamon_akka_http_2_12",
        "@maven//:io_kamon_kamon_core_2_12",
        "@maven//:io_kamon_kamon_executors_2_12",
        "@maven//:io_kamon_kamon_instrumentation_common_2_12",
        "@maven//:io_kamon_kamon_logback_2_12",
        "@maven//:io_kamon_kamon_prometheus_2_12",
        "@maven//:io_kamon_kamon_scala_future_2_12",
        "@maven//:io_netty_netty_buffer",
        "@maven//:io_netty_netty_codec",
        "@maven//:io_netty_netty_codec_dns",
        "@maven//:io_netty_netty_codec_http",
        "@maven//:io_netty_netty_codec_http2",
        "@maven//:io_netty_netty_codec_socks",
        "@maven//:io_netty_netty_common",
        "@maven//:io_netty_netty_handler",
        "@maven//:io_netty_netty_handler_proxy",
        "@maven//:io_netty_netty_resolver",
        "@maven//:io_netty_netty_resolver_dns",
        "@maven//:io_netty_netty_tcnative_boringssl_static",
        "@maven//:io_netty_netty_transport",
        "@maven//:io_netty_netty_transport_native_epoll_linux_x86_64",
        "@maven//:io_netty_netty_transport_native_unix_common",
        "@maven//:io_pebbletemplates_pebble",
        "@maven//:io_sgr_s2_geometry_library_java",
        "@maven//:io_spray_spray_json_2_12",
        "@maven//:io_suzaku_boopickle_2_12",
        "@maven//:io_swagger_swagger_annotations",
        "@maven//:io_swagger_swagger_core",
        "@maven//:io_swagger_swagger_jaxrs",
        "@maven//:io_swagger_swagger_models",
        "@maven//:javax_jms_javax_jms_api",
        "@maven//:javax_servlet_javax_servlet_api",
        "@maven//:javax_servlet_jstl",
        "@maven//:javax_validation_validation_api",
        "@maven//:javax_ws_rs_jsr311_api",
        "@maven//:javax_xml_bind_jaxb_api",
        "@maven//:joda_time_joda_time",
        "@maven//:junit_junit",
        "@maven//:log4j_log4j",
        "@maven//:net_debasishg_redisclient_2_12",
        "@maven//:net_java_dev_jna_jna",
        "@maven//:net_java_dev_jna_jna_platform",
        "@maven//:net_sf_ehcache_ehcache",
        "@maven//:net_sf_saxon_Saxon_HE",
        "@maven//:net_sourceforge_cssparser_cssparser",
        "@maven//:net_sourceforge_htmlunit_htmlunit",
        "@maven//:net_sourceforge_htmlunit_htmlunit_core_js",
        "@maven//:net_sourceforge_htmlunit_neko_htmlunit",
        "@maven//:org_apache_commons_commons_collections4",
        "@maven//:org_apache_commons_commons_csv",
        "@maven//:org_apache_commons_commons_exec",
        "@maven//:org_apache_commons_commons_lang3",
        "@maven//:org_apache_commons_commons_math3",
        "@maven//:org_apache_commons_commons_pool2",
        "@maven//:org_apache_commons_commons_text",
        "@maven//:org_apache_httpcomponents_fluent_hc",
        "@maven//:org_apache_httpcomponents_httpclient",
        "@maven//:org_apache_httpcomponents_httpclient_cache",
        "@maven//:org_apache_httpcomponents_httpclient_osgi",
        "@maven//:org_apache_httpcomponents_httpcore",
        "@maven//:org_apache_httpcomponents_httpcore_nio",
        "@maven//:org_apache_httpcomponents_httpcore_osgi",
        "@maven//:org_apache_httpcomponents_httpmime",
        "@maven//:org_apache_jena_apache_jena_libs",
        "@maven//:org_apache_jena_jena_arq",
        "@maven//:org_apache_jena_jena_base",
        "@maven//:org_apache_jena_jena_cmds",
        "@maven//:org_apache_jena_jena_core",
        "@maven//:org_apache_jena_jena_iri",
        "@maven//:org_apache_jena_jena_rdfconnection",
        "@maven//:org_apache_jena_jena_shaded_guava",
        "@maven//:org_apache_jena_jena_tdb",
        "@maven//:org_apache_jena_jena_text",
        "@maven//:org_apache_lucene_lucene_analyzers_common",
        "@maven//:org_apache_lucene_lucene_core",
        "@maven//:org_apache_lucene_lucene_highlighter",
        "@maven//:org_apache_lucene_lucene_join",
        "@maven//:org_apache_lucene_lucene_memory",
        "@maven//:org_apache_lucene_lucene_queries",
        "@maven//:org_apache_lucene_lucene_queryparser",
        "@maven//:org_apache_lucene_lucene_sandbox",
        "@maven//:org_apache_lucene_lucene_spatial3d",
        "@maven//:org_apache_lucene_lucene_spatial_extras",
        "@maven//:org_apache_solr_solr_solrj",
        "@maven//:org_apache_thrift_libthrift",
        "@maven//:org_apache_zookeeper_zookeeper",
        "@maven//:org_aspectj_aspectjweaver",
        "@maven//:org_bouncycastle_bcpkix_jdk15on",
        "@maven//:org_bouncycastle_bcprov_jdk15on",
        "@maven//:org_checkerframework_checker_qual",
        "@maven//:org_codehaus_woodstox_stax2_api",
        "@maven//:org_codehaus_woodstox_woodstox_core_asl",
        "@maven//:org_eclipse_jetty_jetty_client",
        "@maven//:org_eclipse_jetty_jetty_http",
        "@maven//:org_eclipse_jetty_jetty_io",
        "@maven//:org_eclipse_jetty_jetty_util",
        "@maven//:org_eclipse_jetty_websocket_websocket_api",
        "@maven//:org_eclipse_jetty_websocket_websocket_client",
        "@maven//:org_eclipse_jetty_websocket_websocket_common",
        "@maven//:org_eclipse_rdf4j_rdf4j_client",
        "@maven//:org_eclipse_rdf4j_rdf4j_config",
        "@maven//:org_eclipse_rdf4j_rdf4j_console",
        "@maven//:org_eclipse_rdf4j_rdf4j_http_client",
        "@maven//:org_eclipse_rdf4j_rdf4j_http_protocol",
        "@maven//:org_eclipse_rdf4j_rdf4j_http_server_spring",
        "@maven//:org_eclipse_rdf4j_rdf4j_lucene_spin",
        "@maven//:org_eclipse_rdf4j_rdf4j_model",
        "@maven//:org_eclipse_rdf4j_rdf4j_query",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryalgebra_evaluation",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryalgebra_geosparql",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryalgebra_model",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryparser_api",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryparser_serql",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryparser_sparql",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryrender",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryresultio_api",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryresultio_binary",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryresultio_sparqljson",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryresultio_sparqlxml",
        "@maven//:org_eclipse_rdf4j_rdf4j_queryresultio_text",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_api",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_contextaware",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_dataset",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_event",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_http",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_manager",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_sail",
        "@maven//:org_eclipse_rdf4j_rdf4j_repository_sparql",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_api",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_binary",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_datatypes",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_jsonld",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_languages",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_n3",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_nquads",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_ntriples",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_rdfjson",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_rdfxml",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_trig",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_trix",
        "@maven//:org_eclipse_rdf4j_rdf4j_rio_turtle",
        "@maven//:org_eclipse_rdf4j_rdf4j_runtime",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_api",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_base",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_elasticsearch",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_federation",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_inferencer",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_lucene_api",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_memory",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_model",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_nativerdf",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_solr",
        "@maven//:org_eclipse_rdf4j_rdf4j_sail_spin",
        "@maven//:org_eclipse_rdf4j_rdf4j_spin",
        "@maven//:org_eclipse_rdf4j_rdf4j_storage",
        "@maven//:org_eclipse_rdf4j_rdf4j_util",
        "@maven//:org_hamcrest_hamcrest_core",
        "@maven//:org_hdrhistogram_HdrHistogram",
        "@maven//:org_javassist_javassist",
        "@maven//:org_jline_jline",
        "@maven//:org_joda_joda_convert",
        "@maven//:org_jodd_jodd",
        "@maven//:org_jodd_jodd_core",
        "@maven//:org_jodd_jodd_lagarto",
        "@maven//:org_jodd_jodd_log",
        "@maven//:org_json4s_json4s_ast_2_12",
        "@maven//:org_json4s_json4s_core_2_12",
        "@maven//:org_json4s_json4s_jackson_2_12",
        "@maven//:org_json4s_json4s_scalap_2_12",
        "@maven//:org_locationtech_jts_jts_core",
        "@maven//:org_locationtech_spatial4j_spatial4j",
        "@maven//:org_mapdb_mapdb",
        "@maven//:org_nanohttpd_nanohttpd",
        "@maven//:org_noggit_noggit",
        "@maven//:org_objenesis_objenesis",
        "@maven//:org_reactivestreams_reactive_streams",
        "@maven//:org_reflections_reflections",
        "@maven//:org_rogach_scallop_2_12",
        "@maven//:org_scala_lang_modules_scala_java8_compat_2_12",
        "@maven//:org_scala_lang_modules_scala_parser_combinators_2_12",
        "@maven//:org_scala_lang_modules_scala_swing_2_12",
        "@maven//:org_scala_lang_modules_scala_xml_2_12",
        "@maven//:org_scala_lang_scala_library",
        "@maven//:org_scala_lang_scala_reflect",
        "@maven//:org_scala_sbt_test_interface",
        "@maven//:org_scala_stm_scala_stm_2_12",
        "@maven//:org_scalactic_scalactic_2_12",
        "@maven//:org_simpleflatmapper_lightning_csv",
        "@maven//:org_simpleflatmapper_sfm_util",
        "@maven//:org_slf4j_jcl_over_slf4j",
        "@maven//:org_slf4j_slf4j_api",
        "@maven//:org_slf4j_slf4j_log4j12",
        "@maven//:org_spire_math_jawn_parser_2_12",
        "@maven//:org_springframework_security_spring_security_core",
        "@maven//:org_springframework_spring_aop",
        "@maven//:org_springframework_spring_beans",
        "@maven//:org_springframework_spring_context",
        "@maven//:org_springframework_spring_core",
        "@maven//:org_springframework_spring_expression",
        "@maven//:org_springframework_spring_jcl",
        "@maven//:org_springframework_spring_web",
        "@maven//:org_springframework_spring_webmvc",
        "@maven//:org_typelevel_cats_core_2_12",
        "@maven//:org_typelevel_cats_kernel_2_12",
        "@maven//:org_typelevel_cats_macros_2_12",
        "@maven//:org_typelevel_machinist_2_12",
        "@maven//:org_typelevel_spire_macros_2_12",
        "@maven//:org_unbescape_unbescape",
        "@maven//:org_w3c_css_sac",
        "@maven//:org_xmlunit_xmlunit_core",
        "@maven//:org_yaml_snakeyaml",
        "@maven//:redis_clients_jedis",
        "@maven//:taglibs_standard",
        "@maven//:xalan_serializer",
        "@maven//:xalan_xalan",
        "@maven//:xerces_xercesImpl",
        "@maven//:xml_apis_xml_apis",
    ],
)

filegroup(
    name = "webapi_test_resources",
    srcs = glob([
        "src/test/resources/**",
    ]),
)

scala_test(
    name = "webapi_test",
    srcs = glob(["src/test/scala/org/knora/webapi/**/*.scala"]),
    resources = ["webapi_test_resources"],
    size = "large", # Expect this test to run slowly
    deps = [
        ":webapi",
        "@maven//:com_typesafe_akka_akka_testkit_2_12",
        "@maven//:com_typesafe_akka_akka_stream_testkit_2_12",
        "@maven//:com_typesafe_akka_akka_http_testkit_2_12",
        "@maven//:org_scalatest_scalatest_2_12",
        "@maven//:io_gatling_highcharts_gatling_charts_highcharts",
        "@maven//:io_gatling_gatling_test_framework",
    ],
    data = [
        ":webapi_test_resources",
    ],
)

filegroup(
    name = "webapi_it_resources",
    srcs = glob([
        "src/it/resources/**",
    ]),
)

scala_test(
    name = "webapi_it",
    srcs = glob(["src/it/scala/org/knora/webapi/**/*.scala"]),
    resources = [":webapi_it_resources"],
    size = "large", # Expect this test to run slowly
    deps = [
        ":webapi",
        "@maven//:com_typesafe_akka_akka_testkit_2_12",
        "@maven//:com_typesafe_akka_akka_stream_testkit_2_12",
        "@maven//:com_typesafe_akka_akka_http_testkit_2_12",
        "@maven//:org_scalatest_scalatest_2_12",
        "@maven//:io_gatling_highcharts_gatling_charts_highcharts",
        "@maven//:io_gatling_gatling_test_framework",
    ],
    data = [
        ":webapi_it_resources",

    ],
)